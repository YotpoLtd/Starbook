sudo: required
dist: trusty
language: generic
services:
  - docker
env:
  global:
  - PROJECT="hive"
  - BUILD_DATE=$(date +"%Y-%m-%d_%H-%M-%S")
before_install:
  - pip install --user awscli
  - export PATH=$PATH:$HOME/.local/bin
  - eval $(aws ecr get-login --region us-east-1)
script:
  - docker build -t 402837048690.dkr.ecr.us-east-1.amazonaws.com/${PROJECT}/front:${TRAVIS_COMMIT} -f Dockerfile.front.prod
  - docker build -t 402837048690.dkr.ecr.us-east-1.amazonaws.com/${PROJECT}/back:${TRAVIS_COMMIT} starbook-backend
after_success:
  - "./.travis/after_success.sh"
